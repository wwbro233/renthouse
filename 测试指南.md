# 用户信息显示测试指南

## 问题诊断步骤

### 步骤1：检查是否已登录

1. 打开浏览器访问 http://localhost:5174/
2. 导航到"我的"页面
3. 查看页面右上角是否显示"已登录"状态
4. 如果显示"去登录"，说明您还**未登录**

### 步骤2：登录账号

如果您还未登录，请按以下步骤操作：

1. 点击"去登录"按钮
2. 输入手机号：`18512345678`（默认测试账号）
3. 勾选同意协议
4. 点击"获取验证码"
5. 在弹出的提示中查看验证码（演示模式会直接显示）
6. 输入6位验证码
7. 点击"确认"

### 步骤3：验证用户信息显示

登录成功后，您应该能看到：

✅ **用户卡片区域**（渐变绿色背景）：
- 用户头像（圆形）
- "Hi，小谷粒"
- "谷粒点 15"

✅ **页面右上角**：
- "已登录"状态标签（绿色）

✅ **统计数据区域**（底部）：
- 想看房源：8
- 约看记录：实际记录数量
- 服务预约：5
- 社区活动：2

### 步骤4：查看控制台调试信息

1. 按 F12 打开开发者工具
2. 切换到"Console"（控制台）标签
3. 查看输出的调试信息：
   ```
   MyView - currentUser: { id: 'seed-1', phone: '18512345678', name: '小谷粒', ... }
   MyView - isAuthenticated: true
   MyView - authStore.state: { users: [...], currentPhone: '18512345678', ... }
   ```

### 步骤5：测试编辑资料

1. 在"我的"页面点击"编辑资料"按钮
2. 应该能看到表单已自动填充当前用户信息：
   - 头像：默认头像
   - 姓名：小谷粒
   - 手机号：18512345678
   - 其他字段为空（可选填）

3. 尝试修改信息：
   - 修改姓名为"测试用户"
   - 填写邮箱：test@example.com
   - 填写个性签名：这是我的个性签名

4. 点击"保存修改"
5. 1.5秒后自动跳转回"我的"页面
6. 验证信息已更新：
   - 用户卡片显示"Hi，测试用户"
   - 再次点击"编辑资料"，表单中显示更新后的信息

## 常见问题排查

### 问题1：显示"游客"而不是用户名

**原因**：您还未登录

**解决方案**：按照"步骤2：登录账号"进行登录

### 问题2：登录后还是显示"游客"

**原因1**：localStorage 可能被清空或浏览器隐私模式

**解决方案**：
1. 打开控制台，输入：
   ```javascript
   localStorage.getItem('link-house-auth')
   ```
2. 如果返回 null，说明数据丢失，需要重新登录

**原因2**：代码问题

**解决方案**：
1. 查看控制台是否有错误信息
2. 检查调试输出中 `currentUser` 是否为 null
3. 检查 `isAuthenticated` 是否为 false

### 问题3：修改资料后没有保存

**原因**：表单验证失败

**解决方案**：
1. 确保"姓名"字段已填写（必填）
2. 确保"手机号"格式正确（11位数字）
3. 如果填写了邮箱，确保格式正确
4. 如果填写了密码，确保至少6位

### 问题4：刷新页面后登录状态丢失

**原因**：localStorage 未正确保存

**解决方案**：
1. 检查浏览器是否禁用了 localStorage
2. 检查是否在隐私/无痕模式下浏览
3. 清空 localStorage 后重新登录：
   ```javascript
   localStorage.clear()
   location.reload()
   ```

## 手动检查 localStorage

在浏览器控制台中运行以下命令：

```javascript
// 查看存储的数据
const authData = JSON.parse(localStorage.getItem('link-house-auth'))
console.log('存储的用户数据：', authData)

// 查看当前登录的手机号
console.log('当前登录手机号：', authData?.currentPhone)

// 查看所有用户
console.log('所有用户：', authData?.users)
```

## 预期输出示例

### 未登录状态
```javascript
currentUser: null
isAuthenticated: false
界面显示：游客、谷粒点 0
```

### 已登录状态（默认用户）
```javascript
currentUser: {
  id: 'seed-1',
  phone: '18512345678',
  name: '小谷粒',
  nickname: '谷粒会员',
  avatar: '[SVG路径]',
  points: 15
}
isAuthenticated: true
界面显示：小谷粒、谷粒点 15
```

### 已登录状态（修改资料后）
```javascript
currentUser: {
  id: 'seed-1',
  phone: '18512345678',
  name: '测试用户',           // ← 已修改
  nickname: '谷粒会员',
  email: 'test@example.com', // ← 新增
  signature: '这是我的个性签名', // ← 新增
  ...
}
```

## 如果问题仍然存在

请提供以下信息：

1. 控制台调试输出的截图
2. localStorage 数据的内容
3. 是否有任何错误信息
4. 当前看到的页面状态（截图）

这将帮助我更准确地定位问题。

