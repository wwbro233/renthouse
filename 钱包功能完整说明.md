# 钱包功能完整说明 💰

## 🎯 功能概述

完整的钱包管理系统，支持账户余额管理、谷粒点（积分）系统、交易记录查询等功能。

**快速访问：** http://localhost:5174/my/wallet

---

## ✨ 核心功能

### 1️⃣ 账户余额管理
- 💰 查看账户余额
- ➕ 充值功能（支持快捷金额）
- ➖ 提现功能（1-3工作日到账）
- 📊 实时余额更新

### 2️⃣ 谷粒点（积分）系统
- 🏆 查看谷粒点余额
- 📅 每日签到赚积分（随机5-10点）
- 🎁 积分兑换余额（100点 = ¥10）
- 💝 充值赠送积分（充值100元送10点）

### 3️⃣ 交易记录管理
- 📝 完整交易历史
- 🔍 分类筛选（充值/提现/支付/退款/积分）
- 📊 交易状态追踪
- 🕐 时间记录

### 4️⃣ 交易类型
- **充值**：增加账户余额
- **提现**：提取账户余额到银行卡
- **支付**：使用余额支付订单
- **退款**：订单退款到余额
- **积分获得**：签到、活动奖励等
- **积分使用**：兑换余额、抵扣等

---

## 🎨 界面展示

### 钱包主页布局

```
┌─────────────────────────────────────────────────┐
│ 首页 / 我的 / 我的钱包                          │
├─────────────────────────────────────────────────┤
│                                                 │
│ ┌────────────────────┐  ┌──────────────────┐  │
│ │ 💼 账户余额        │  │ 🏆 谷粒点        │  │
│ │                    │  │                  │  │
│ │ ¥2,580.00          │  │ 156              │  │
│ │                    │  │                  │  │
│ │ [➕充值] [➖提现]  │  │ [📅签到][🎁兑换]│  │
│ └────────────────────┘  │ 💡 100点=¥10    │  │
│                         └──────────────────┘  │
│                                                 │
│ ┌─────────────────────────────────────────┐   │
│ │ 📝 交易记录                  共 X 条    │   │
│ ├─────────────────────────────────────────┤   │
│ │ [全部][充值][提现][支付][退款][积分]   │   │
│ ├─────────────────────────────────────────┤   │
│ │                                         │   │
│ │ 🟢 充值 ¥500                  +¥500    │   │
│ │    2024-11-06 10:30          ✅已完成  │   │
│ │                                         │   │
│ │ 🔴 支付订单费用               -¥199    │   │
│ │    2024-11-05 15:20          ✅已完成  │   │
│ │                                         │   │
│ │ 🟡 每日签到奖励               +8点     │   │
│ │    2024-11-05 09:00          ✅已完成  │   │
│ │                                         │   │
│ └─────────────────────────────────────────┘   │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 💡 使用指南

### 场景1：充值余额

**步骤：**
1. 访问钱包页面：http://localhost:5174/my/wallet
2. 点击余额卡片的 **"充值"** 按钮
3. 选择快捷金额或输入自定义金额
   - 快捷金额：¥100、¥200、¥500、¥1000、¥2000、¥5000
4. 点击"确认充值"
5. 确认充值信息
6. 充值成功，余额增加
7. **充值奖励**：充值100元自动赠送10谷粒点

**界面展示：**
```
┌──────────────────────────────────┐
│           💰 充值                │
├──────────────────────────────────┤
│                                  │
│  [¥100] [¥200] [¥500]           │
│  [¥1000][¥2000][¥5000]          │
│                                  │
│  ┌────────────────────────┐     │
│  │ ¥ [输入金额]           │     │
│  └────────────────────────┘     │
│                                  │
│  💡 充值100元赠送10谷粒点        │
│                                  │
│         [取消]    [确认充值]     │
└──────────────────────────────────┘
```

---

### 场景2：提现

**步骤：**
1. 点击余额卡片的 **"提现"** 按钮
2. 查看当前余额
3. 输入提现金额（不能超过余额）
4. 点击"确认提现"
5. 提现申请提交成功
6. **到账时间**：1-3个工作日

**界面展示：**
```
┌──────────────────────────────────┐
│           💸 提现                │
├──────────────────────────────────┤
│                                  │
│  当前余额：¥2,580.00             │
│                                  │
│  ┌────────────────────────┐     │
│  │ ¥ [输入提现金额]       │     │
│  └────────────────────────┘     │
│                                  │
│  💡 提现将在1-3个工作日内到账    │
│                                  │
│         [取消]    [确认提现]     │
└──────────────────────────────────┘
```

---

### 场景3：每日签到赚积分

**步骤：**
1. 访问钱包页面
2. 点击谷粒点卡片的 **"每日签到"** 按钮
3. 系统随机赠送5-10谷粒点
4. 提示"获得X谷粒点"
5. 积分余额增加

**奖励机制：**
- 每日签到：5-10谷粒点（随机）
- 充值奖励：充值100元送10点
- 完成订单：根据订单金额赠送
- 活动奖励：参与活动获得

---

### 场景4：积分兑换余额

**步骤：**
1. 点击谷粒点卡片的 **"兑换余额"** 按钮
2. 确认兑换：100谷粒点 = ¥10
3. 检查积分是否足够
4. 点击"确认兑换"
5. 积分扣除100点
6. 余额增加¥10

**兑换规则：**
```
100 谷粒点 = ¥10
200 谷粒点 = ¥20
500 谷粒点 = ¥50
1000 谷粒点 = ¥100
```

---

### 场景5：查看交易记录

**步骤：**
1. 滚动到交易记录区域
2. 使用标签筛选：
   - **全部**：显示所有交易
   - **充值**：只显示充值记录
   - **提现**：只显示提现记录
   - **支付**：只显示支付记录
   - **退款**：只显示退款记录
   - **积分**：只显示积分相关记录
3. 查看交易详情：
   - 交易类型和描述
   - 交易金额（绿色为收入，红色为支出）
   - 交易时间
   - 交易状态

**交易记录示例：**
```
┌─────────────────────────────────────┐
│ 🟢 充值 ¥500，赠送50谷粒点         │
│    2024-11-06 10:30      +¥500     │
│                          ✅已完成  │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 🔴 支付订单：深度保洁服务           │
│    2024-11-05 15:20      -¥199     │
│                          ✅已完成  │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 🟡 每日签到奖励                     │
│    2024-11-05 09:00      +8点      │
│                          ✅已完成  │
└─────────────────────────────────────┘
```

---

## 🔧 技术实现

### walletStore 核心方法

```javascript
// 获取用户钱包
walletStore.getUserWallet(userPhone)
// 返回：{ balance: 0, points: 15, transactions: [] }

// 充值
walletStore.recharge(userPhone, amount)
// 返回：{ success: true, message: '充值成功', balance: 1000, points: 25 }

// 提现
walletStore.withdraw(userPhone, amount)
// 返回：{ success: true, message: '提现申请已提交', balance: 500 }

// 支付
walletStore.payment(userPhone, amount, description)
// 返回：{ success: true, message: '支付成功', balance: 301 }

// 退款
walletStore.refund(userPhone, amount, description)
// 返回：{ success: true, message: '退款成功', balance: 500 }

// 赚取积分
walletStore.earnPoints(userPhone, points, description)
// 返回：{ success: true, message: '获得10谷粒点', points: 35 }

// 使用积分
walletStore.usePoints(userPhone, points, description)
// 返回：{ success: true, message: '使用100谷粒点成功', points: 56 }

// 获取交易记录
walletStore.getTransactions(userPhone, filter)
// 参数：filter = 'all' | 'recharge' | 'withdraw' | 'payment' | 'refund' | 'points'
```

---

## 📊 数据结构

### 钱包数据

```javascript
{
  balance: 2580.00,  // 余额（元）
  points: 156,       // 谷粒点
  transactions: [    // 交易记录
    {
      id: 'TXN1730000000001234',
      type: 'recharge',
      amount: 500,
      points: 50,
      description: '充值 ¥500，赠送50谷粒点',
      status: 'completed',
      createdAt: '2024-11-06T10:30:00.000Z'
    },
    // ... 更多交易
  ]
}
```

### 交易类型

| 类型 | 说明 | 图标 | 颜色 |
|-----|------|------|------|
| recharge | 充值 | Plus | 绿色 |
| withdraw | 提现 | Minus | 红色 |
| payment | 支付 | ShoppingCart | 蓝色 |
| refund | 退款 | RefreshLeft | 绿色 |
| points_earn | 积分获得 | TrophyBase | 黄色 |
| points_use | 积分使用 | Present | 紫色 |

### 交易状态

| 状态 | 说明 | 标签颜色 |
|-----|------|---------|
| pending | 处理中 | 橙色 |
| completed | 已完成 | 绿色 |
| failed | 失败 | 红色 |

---

## 💰 钱包规则

### 余额规则
1. **充值**：
   - 最低充值：¥10
   - 无最高限制
   - 充值100元赠送10谷粒点

2. **提现**：
   - 最低提现：¥10
   - 不能超过当前余额
   - 1-3个工作日到账
   - 每日提现次数不限

3. **支付**：
   - 余额不足无法支付
   - 支付成功立即扣款

4. **退款**：
   - 退款立即到账
   - 退至钱包余额

### 积分规则
1. **获得积分**：
   - 每日签到：5-10点（随机）
   - 充值奖励：充值100元送10点
   - 完成订单：订单金额的1%
   - 活动奖励：根据活动规则

2. **使用积分**：
   - 兑换余额：100点 = ¥10
   - 积分抵扣：支付时使用
   - 积分不足无法兑换

3. **积分有效期**：
   - 永久有效（当前版本）

---

## 🎁 充值奖励规则

| 充值金额 | 赠送谷粒点 |
|---------|-----------|
| ¥100    | 10点      |
| ¥200    | 20点      |
| ¥500    | 50点      |
| ¥1000   | 100点     |
| ¥2000   | 200点     |
| ¥5000   | 500点     |

**计算公式：** 谷粒点 = 充值金额 / 10

---

## 📱 响应式设计

### 桌面端（>991px）
- 钱包卡片：2列布局（余额卡片占1.5份，积分卡片占1份）
- 交易记录：横向布局
- 快捷充值：3列网格

### 平板端（768-991px）
- 钱包卡片：1列布局
- 快捷充值：2列网格

### 移动端（<768px）
- 钱包卡片：纵向布局
- 按钮：全宽显示
- 交易记录：紧凑布局

---

## 🚀 快速测试

### 测试1：充值流程

```bash
# 1. 登录账号
手机号：18512345678

# 2. 访问钱包
http://localhost:5174/my/wallet

# 3. 点击充值
选择¥100 → 确认充值

# 4. 验证结果
- 余额增加¥100
- 谷粒点增加10点
- 交易记录新增一条充值记录
```

### 测试2：签到赚积分

```bash
# 1. 访问钱包页面
# 2. 点击"每日签到"
# 3. 验证
- 谷粒点增加5-10点
- 交易记录新增签到记录
```

### 测试3：积分兑换

```bash
# 1. 确保谷粒点 ≥ 100
# 2. 点击"兑换余额"
# 3. 确认兑换
# 4. 验证
- 谷粒点减少100
- 余额增加¥10
- 交易记录新增两条（积分使用+充值）
```

### 测试4：提现流程

```bash
# 1. 确保余额 > 0
# 2. 点击"提现"
# 3. 输入提现金额
# 4. 确认提现
# 5. 验证
- 余额减少
- 交易记录新增提现记录（状态：处理中）
```

---

## ⚠️ 注意事项

### 1. 余额不足
- 提现或支付时余额不足会提示错误
- 建议先充值再进行操作

### 2. 积分不足
- 兑换或使用积分时不足会提示错误
- 可通过签到、充值等方式获得积分

### 3. 数据持久化
- 所有钱包数据保存在 localStorage
- Key: `link-house-wallet`
- 清除浏览器数据会丢失钱包信息

### 4. 安全提示
- 当前为演示版本，使用模拟充值/提现
- 生产环境需要集成真实支付接口
- 建议添加支付密码保护

---

## 🔗 与其他功能的集成

### 1. 与订单系统集成
```
创建订单 → 使用余额支付 → 扣除余额 → 记录交易
订单取消 → 退款到余额 → 增加余额 → 记录交易
```

### 2. 与用户系统集成
```
用户注册 → 创建钱包 → 初始化余额和积分
用户登录 → 加载钱包数据 → 显示余额和积分
```

### 3. 与积分系统集成
```
完成任务 → 获得积分 → 记录交易
签到打卡 → 获得积分 → 记录交易
积分兑换 → 扣除积分 → 记录交易
```

---

## 📈 统计数据

### 钱包统计（管理员视角）

```javascript
walletStore.walletStats.value
// 返回：
{
  totalUsers: 10,        // 总用户数
  totalBalance: 25800,   // 总余额
  totalPoints: 1560,     // 总积分
  totalTransactions: 45  // 总交易数
}
```

---

## 🌟 功能亮点

1. ✅ **完整的钱包系统**：余额+积分双账户
2. ✅ **灵活的充值方式**：快捷金额+自定义金额
3. ✅ **丰富的积分获取**：签到+充值奖励+活动奖励
4. ✅ **积分兑换功能**：100点兑换¥10
5. ✅ **详细的交易记录**：分类筛选，状态追踪
6. ✅ **实时数据更新**：响应式界面
7. ✅ **数据持久化**：localStorage存储
8. ✅ **用户友好**：清晰的界面，明确的提示

---

## 🎯 使用建议

### 新用户
1. 登录后立即签到赚取积分
2. 小额充值体验功能（¥100）
3. 尝试积分兑换余额
4. 查看交易记录了解消费情况

### 日常使用
1. 每天登录签到赚积分
2. 充值时选择¥100的整数倍获得更多积分
3. 积分达到100时及时兑换
4. 定期查看交易记录

### 注意事项
1. 保持一定余额以便支付订单
2. 积分及时使用，不要浪费
3. 提现需要1-3个工作日，提前规划
4. 充值时选择合适金额，避免浪费

---

## 📚 相关文档

- `src/stores/walletStore.js` - 钱包状态管理
- `src/views/MyWalletView.vue` - 钱包页面
- `src/router/index.js` - 路由配置
- `src/views/MyView.vue` - 我的页面（钱包入口）

---

## 🎉 现在开始使用

**快速入口：**
- 💰 我的钱包：http://localhost:5174/my/wallet
- 🏠 我的页面：http://localhost:5174/my （点击钱包图标）

**第一步：** 登录账号（手机号：18512345678）
**第二步：** 访问钱包页面
**第三步：** 充值并赚取积分
**第四步：** 体验签到和兑换功能

---

**祝您使用愉快！** 💰✨

