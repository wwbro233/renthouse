# ä¸ªäººä¸­å¿ƒåŠŸèƒ½å®ç°æŠ€æœ¯æ–‡æ¡£

> ç§Ÿæˆ¿APPä¸ªäººä¸­å¿ƒæ¨¡å—çš„å®Œæ•´æŠ€æœ¯å®ç°è¯´æ˜

---

## ğŸ“š ç›®å½•

- [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
- [æ ¸å¿ƒæŠ€æœ¯æ ˆ](#æ ¸å¿ƒæŠ€æœ¯æ ˆ)
- [åŠŸèƒ½æ¨¡å—è¯¦è§£](#åŠŸèƒ½æ¨¡å—è¯¦è§£)
  - [1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ](#1-ç”¨æˆ·è®¤è¯ç³»ç»Ÿ)
  - [2. ä¸ªäººä¸­å¿ƒä¸»é¡µ](#2-ä¸ªäººä¸­å¿ƒä¸»é¡µ)
  - [3. æƒ³çœ‹æˆ¿æºç®¡ç†](#3-æƒ³çœ‹æˆ¿æºç®¡ç†)
  - [4. è¶³è¿¹è®°å½•](#4-è¶³è¿¹è®°å½•)
  - [5. çº¦çœ‹é¢„çº¦ç³»ç»Ÿ](#5-çº¦çœ‹é¢„çº¦ç³»ç»Ÿ)
  - [6. æ‹¼ç§Ÿä¿¡æ¯](#6-æ‹¼ç§Ÿä¿¡æ¯)
  - [7. è®¢å•ç®¡ç†ç³»ç»Ÿ](#7-è®¢å•ç®¡ç†ç³»ç»Ÿ)
  - [8. é’±åŒ…ç³»ç»Ÿ](#8-é’±åŒ…ç³»ç»Ÿ)
  - [9. ä¸ªäººèµ„æ–™ç®¡ç†](#9-ä¸ªäººèµ„æ–™ç®¡ç†)
- [çŠ¶æ€ç®¡ç†è®¾è®¡](#çŠ¶æ€ç®¡ç†è®¾è®¡)
- [æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ](#æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ)
- [è·¯ç”±è®¾è®¡](#è·¯ç”±è®¾è®¡)
- [ç»„ä»¶é€šä¿¡æœºåˆ¶](#ç»„ä»¶é€šä¿¡æœºåˆ¶)
- [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
- [å®‰å…¨æ€§è€ƒè™‘](#å®‰å…¨æ€§è€ƒè™‘)
- [æœªæ¥ä¼˜åŒ–æ–¹å‘](#æœªæ¥ä¼˜åŒ–æ–¹å‘)

---

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·ç•Œé¢å±‚                    â”‚
â”‚  MyView.vue (ä¸ªäººä¸­å¿ƒä¸»é¡µ)                     â”‚
â”‚  â”œâ”€ MyWantView.vue (æƒ³çœ‹æˆ¿æº)                  â”‚
â”‚  â”œâ”€ MyFootprintView.vue (è¶³è¿¹)                 â”‚
â”‚  â”œâ”€ MyAppointmentView.vue (çº¦çœ‹)               â”‚
â”‚  â”œâ”€ MyShareView.vue (æ‹¼ç§Ÿ)                     â”‚
â”‚  â”œâ”€ MyOrderView.vue (è®¢å•)                     â”‚
â”‚  â”œâ”€ MyWalletView.vue (é’±åŒ…)                    â”‚
â”‚  â””â”€ UserProfileView.vue (ä¸ªäººèµ„æ–™)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 çŠ¶æ€ç®¡ç†å±‚ (Stores)             â”‚
â”‚  â”œâ”€ authStore.js (ç”¨æˆ·è®¤è¯)                    â”‚
â”‚  â”œâ”€ bookingStore.js (é¢„çº¦ç®¡ç†)                 â”‚
â”‚  â”œâ”€ orderStore.js (è®¢å•ç®¡ç†)                   â”‚
â”‚  â””â”€ walletStore.js (é’±åŒ…ç®¡ç†)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ•°æ®æŒä¹…åŒ–å±‚                     â”‚
â”‚  localStorage (link-house-*)                   â”‚
â”‚  â”œâ”€ link-house-auth (ç”¨æˆ·æ•°æ®)                 â”‚
â”‚  â”œâ”€ link-house-orders (è®¢å•æ•°æ®)               â”‚
â”‚  â””â”€ link-house-wallet (é’±åŒ…æ•°æ®)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯é€‰å‹ç†ç”±

| æŠ€æœ¯ | é€‰ç”¨åŸå›  |
|-----|---------|
| Vue 3 | ç»„åˆå¼APIæä¾›æ›´å¥½çš„ä»£ç ç»„ç»‡å’Œç±»å‹æ¨å¯¼ |
| Pinia/Reactive | è½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œå®Œç¾é€‚é…Vue 3 |
| Vue Router | å®˜æ–¹è·¯ç”±è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒåµŒå¥—è·¯ç”±å’Œè·¯ç”±å®ˆå« |
| Element Plus | æˆç†Ÿçš„UIç»„ä»¶åº“ï¼Œæä¾›ä¸°å¯Œçš„äº¤äº’ç»„ä»¶ |
| localStorage | ç®€å•æœ‰æ•ˆçš„æœ¬åœ°å­˜å‚¨æ–¹æ¡ˆï¼Œé€‚åˆæ¼”ç¤ºé¡¹ç›® |
| Vite | å¿«é€Ÿçš„å¼€å‘æœåŠ¡å™¨å’Œæ„å»ºå·¥å…· |

---

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

### å‰ç«¯æ¡†æ¶
- **Vue 3.3+**ï¼šé‡‡ç”¨ç»„åˆå¼API (Composition API)
- **Vue Router 4.x**ï¼šå•é¡µåº”ç”¨è·¯ç”±ç®¡ç†
- **Element Plus**ï¼šUIç»„ä»¶åº“

### çŠ¶æ€ç®¡ç†
- **Reactive API**ï¼šVue 3åŸç”Ÿå“åº”å¼çŠ¶æ€ç®¡ç†
- **Computed**ï¼šè®¡ç®—å±æ€§ç”¨äºè¡ç”ŸçŠ¶æ€
- **Watch**ï¼šç›‘å¬æ•°æ®å˜åŒ–

### å·¥å…·åº“
- **Vite**ï¼šæ„å»ºå·¥å…·
- **ESLint**ï¼šä»£ç è§„èŒƒ
- **Prettier**ï¼šä»£ç æ ¼å¼åŒ–

### æ•°æ®å­˜å‚¨
- **localStorage**ï¼šæµè§ˆå™¨æœ¬åœ°å­˜å‚¨
- **JSONåºåˆ—åŒ–**ï¼šæ•°æ®æŒä¹…åŒ–æ ¼å¼

---

## åŠŸèƒ½æ¨¡å—è¯¦è§£

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/stores/authStore.js` - è®¤è¯çŠ¶æ€ç®¡ç†
- `src/views/LoginView.vue` - ç™»å½•é¡µé¢
- `src/views/UserProfileView.vue` - ä¸ªäººèµ„æ–™

**å®ç°åŸç†ï¼š**

```javascript
// authStore.js æ ¸å¿ƒå®ç°
import { computed, reactive } from 'vue'

const state = reactive({
  users: [],           // ç”¨æˆ·åˆ—è¡¨
  currentPhone: null,  // å½“å‰ç™»å½•ç”¨æˆ·æ‰‹æœºå·
  pending: {           // éªŒè¯ç çŠ¶æ€
    phone: '',
    code: '',
    expires: 0
  }
})

// è®¡ç®—å±æ€§ï¼šå½“å‰ç”¨æˆ·
const currentUser = computed(() => {
  if (!state.currentPhone) return null
  const user = findUser(state.currentPhone)
  
  // åŒæ­¥é’±åŒ…ç§¯åˆ†
  try {
    const walletStore = useWalletStore()
    const wallet = walletStore.getUserWallet(state.currentPhone)
    if (wallet) {
      user.points = wallet.points
    }
  } catch (error) {
    // å¿½ç•¥é”™è¯¯
  }
  
  return user
})

// è®¡ç®—å±æ€§ï¼šç™»å½•çŠ¶æ€
const isAuthenticated = computed(() => !!currentUser.value)
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**

1. **éªŒè¯ç ç™»å½•æœºåˆ¶**
   ```javascript
   // ç”Ÿæˆ6ä½éªŒè¯ç 
   const generateCode = () => `${Math.floor(100000 + Math.random() * 900000)}`
   
   // éªŒè¯ç æœ‰æ•ˆæœŸç®¡ç†ï¼ˆ2åˆ†é’Ÿï¼‰
   pending: {
     phone: trimmedPhone,
     code: generatedCode,
     expires: Date.now() + 2 * 60 * 1000
   }
   ```

2. **ç”¨æˆ·æ³¨å†Œæµç¨‹**
   ```javascript
   const registerUser = ({ phone, name }) => {
     // æ‰‹æœºå·æ ¼å¼éªŒè¯
     if (!/^1\d{10}$/.test(trimmedPhone)) {
       return { success: false, message: 'è¯·è¾“å…¥æ­£ç¡®çš„11ä½æ‰‹æœºå·' }
     }
     
     // åˆ›å»ºç”¨æˆ·å¯¹è±¡
     const user = {
       id: `user-${Date.now()}`,
       phone: trimmedPhone,
       name: name?.trim() || `è°·ç²’ç”¨æˆ·${trimmedPhone.slice(-4)}`,
       nickname: 'è°·ç²’è®¡åˆ’æ–°æˆå‘˜',
       avatar: generateAvatar(trimmedPhone),
       points: 0
     }
     
     // æ·»åŠ åˆ°ç”¨æˆ·åˆ—è¡¨å¹¶æŒä¹…åŒ–
     state.users.push(user)
     persist()
   }
   ```

3. **å¤´åƒç”Ÿæˆç®—æ³•**
   ```javascript
   const avatarPool = [
     'avatars/avatar-default.svg',
     'avatars/avatar-review-1.svg',
     'avatars/avatar-review-2.svg',
     'avatars/avatar-landlord.svg'
   ]
   
   const generateAvatar = (phone = '') => {
     // æ ¹æ®æ‰‹æœºå·å“ˆå¸Œé€‰æ‹©å¤´åƒ
     const hash = [...phone].reduce((acc, char) => acc + char.charCodeAt(0), 0)
     const key = avatarPool[hash % avatarPool.length]
     return assetUrl(key)
   }
   ```

4. **æ•°æ®æŒä¹…åŒ–**
   ```javascript
   const STORAGE_KEY = 'link-house-auth'
   
   const persist = () => {
     if (!isBrowser) return
     const payload = {
       users: state.users,
       currentPhone: state.currentPhone
     }
     window.localStorage.setItem(STORAGE_KEY, JSON.stringify(payload))
   }
   ```

**å®‰å…¨æœºåˆ¶ï¼š**
- æ‰‹æœºå·æ ¼å¼éªŒè¯ï¼ˆ11ä½æ•°å­—ï¼‰
- éªŒè¯ç è¿‡æœŸæ£€æŸ¥
- é‡å¤æ³¨å†Œæ£€æµ‹
- å¯†ç é•¿åº¦é™åˆ¶ï¼ˆæœ€å°‘6ä½ï¼‰

---

### 2. ä¸ªäººä¸­å¿ƒä¸»é¡µ

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/views/MyView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// å“åº”å¼ç™»å½•çŠ¶æ€
const isAuthenticated = computed(() => authStore.isAuthenticated.value)

// ç”¨æˆ·ä¿¡æ¯è®¡ç®—å±æ€§
const userInfo = computed(() => {
  const user = authStore.currentUser.value
  if (!user) {
    return {
      name: 'æ¸¸å®¢',
      points: 0,
      avatar: assetUrl('avatars/avatar-default.svg')
    }
  }
  return {
    name: user.name,
    points: user.points ?? 0,
    avatar: user.avatar || assetUrl('avatars/avatar-default.svg')
  }
})

// ç»Ÿè®¡æ•°æ®ï¼ˆä»å¤šä¸ªstoreèšåˆï¼‰
const statistics = computed(() => [
  {
    label: 'æƒ³çœ‹æˆ¿æº',
    value: authStore.isAuthenticated.value ? 8 : 0
  },
  {
    label: 'çº¦çœ‹è®°å½•',
    value: authStore.isAuthenticated.value ? bookingStore.state.bookings.length : 0
  },
  {
    label: 'æœåŠ¡é¢„çº¦',
    value: authStore.isAuthenticated.value ? 5 : 0
  },
  {
    label: 'ç¤¾åŒºæ´»åŠ¨',
    value: authStore.isAuthenticated.value ? 2 : 0
  }
])
```

**UIç»„ä»¶è®¾è®¡ï¼š**

1. **å¿«æ·å…¥å£ç½‘æ ¼**
   ```javascript
   const shortcutList = [
     { id: 'wish', label: 'æƒ³çœ‹', icon: 'Collection', route: '/my/want' },
     { id: 'book', label: 'çº¦çœ‹', icon: 'Calendar', route: '/my/appointment' },
     { id: 'order', label: 'è®¢å•', icon: 'List', route: '/my/orders' },
     { id: 'wallet', label: 'é’±åŒ…', icon: 'Wallet', route: '/my/wallet' },
     // ...æ›´å¤šå¿«æ·å…¥å£
   ]
   ```

2. **ä¼šå‘˜è®¡åˆ’å¡ç‰‡**
   - ä½¿ç”¨åŠ¨æ€èƒŒæ™¯è‰²
   - å“åº”å¼å¸ƒå±€
   - ç‚¹å‡»è·³è½¬åŠŸèƒ½

3. **ç»Ÿè®¡æ•°æ®å±•ç¤º**
   - 4åˆ—ç½‘æ ¼å¸ƒå±€
   - å®æ—¶æ•°æ®æ›´æ–°
   - æœªç™»å½•æ˜¾ç¤º0

**å“åº”å¼è®¾è®¡ï¼š**
```css
/* æ¡Œé¢ç«¯ */
.shortcut-wrap {
  grid-template-columns: repeat(5, 1fr);
}

/* ç§»åŠ¨ç«¯ */
@media (max-width: 400px) {
  .shortcut-wrap {
    grid-template-columns: repeat(3, 1fr);
  }
}
```

---

### 3. æƒ³çœ‹æˆ¿æºç®¡ç†

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/views/MyWantView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// æ•°æ®ç®¡ç†
const tableData = ref(myFavorites.map((item) => ({ ...item })))

// è¿‡æ»¤å™¨
const filters = reactive({
  keyword: '',      // å…³é”®è¯æœç´¢
  layout: '',       // æˆ·å‹ç­›é€‰
  priceOrder: ''    // ä»·æ ¼æ’åº
})

// å¤šç»´åº¦è¿‡æ»¤
const filteredData = computed(() => {
  let result = [...tableData.value]
  
  // å…³é”®è¯æœç´¢
  if (filters.keyword) {
    result = result.filter((item) =>
      item.title.toLowerCase().includes(filters.keyword.toLowerCase())
    )
  }
  
  // æˆ·å‹ç­›é€‰
  if (filters.layout) {
    result = result.filter((item) => item.layout.includes(filters.layout))
  }
  
  // ä»·æ ¼æ’åº
  if (filters.priceOrder) {
    const multiplier = filters.priceOrder === 'asc' ? 1 : -1
    result = result.sort((a, b) => (a.price - b.price) * multiplier)
  }
  
  return result
})

// åˆ†é¡µæ•°æ®
const paginatedData = computed(() => {
  const start = (pageState.currentPage - 1) * pageState.pageSize
  return filteredData.value.slice(start, start + pageState.pageSize)
})
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**

1. **å¤šé€‰æ“ä½œ**
   ```javascript
   const selectedIds = ref([])
   
   const handleSelectionChange = (selection) => {
     selectedIds.value = selection.map((item) => item.id)
   }
   
   const handleBatchDelete = () => {
     if (selectedIds.value.length === 0) {
       ElMessage.warning('è¯·é€‰æ‹©è¦åˆ é™¤çš„æˆ¿æº')
       return
     }
     // æ‰¹é‡åˆ é™¤é€»è¾‘
     tableData.value = tableData.value.filter(
       (item) => !selectedIds.value.includes(item.id)
     )
   }
   ```

2. **å®æ—¶æœç´¢**
   ```javascript
   // ç›‘å¬è¿‡æ»¤æ¡ä»¶å˜åŒ–ï¼Œé‡ç½®åˆ†é¡µ
   watch([() => filters.keyword, () => filters.layout], () => {
     pageState.currentPage = 1
   })
   ```

3. **æ’åºç®—æ³•**
   - å‡åº/é™åºæ’åº
   - ä¸æ”¹å˜åŸæ•°ç»„
   - æ”¯æŒé“¾å¼è¿‡æ»¤

---

### 4. è¶³è¿¹è®°å½•

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/views/MyFootprintView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// æ—¶é—´åˆ†ç»„å±•ç¤º
const groupedFootprints = computed(() => {
  const groups = {}
  
  footprintsData.value.forEach((item) => {
    const date = item.viewTime.split(' ')[0]
    if (!groups[date]) {
      groups[date] = []
    }
    groups[date].push(item)
  })
  
  return Object.entries(groups).map(([date, items]) => ({
    date,
    items,
    count: items.length
  }))
})
```

**æ•°æ®ç»“æ„ï¼š**
```javascript
{
  id: 'fp-1',
  propertyId: 'prop-a',
  title: 'æˆ¿æºæ ‡é¢˜',
  cover: 'å°é¢å›¾ç‰‡',
  price: 3200,
  layout: '1å®¤1å…',
  viewTime: '2024-11-05 14:30',
  duration: '5åˆ†é’Ÿ'
}
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- æŒ‰æ—¥æœŸåˆ†ç»„å±•ç¤º
- æŸ¥çœ‹æ¬¡æ•°ç»Ÿè®¡
- å•ä¸ªåˆ é™¤åŠŸèƒ½
- æ¸…ç©ºå…¨éƒ¨åŠŸèƒ½

---

### 5. çº¦çœ‹é¢„çº¦ç³»ç»Ÿ

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/stores/bookingStore.js`
- `src/views/MyAppointmentView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// bookingStore.js
const state = reactive({
  bookings: [],          // é¢„çº¦åˆ—è¡¨
  dialogVisible: false,  // é¢„çº¦å¯¹è¯æ¡†çŠ¶æ€
  preset: null          // é¢„è®¾æ•°æ®
})

// æ·»åŠ é¢„çº¦
const addBooking = (booking) => {
  state.bookings.unshift({
    id: `bk-${Date.now()}`,
    title: booking.title,
    type: booking.type || 'çº¦çœ‹',
    time: booking.time,
    status: booking.status || 'å¾…ç¡®è®¤',
    cover: booking.cover || assetUrl('booking-default.jpg'),
    address: booking.address || 'åœ°å€å¾…ç¡®è®¤',
    contactName: booking.contactName,
    contactPhone: booking.contactPhone,
    remark: booking.remark || ''
  })
  state.dialogVisible = false
}

// æ›´æ–°é¢„çº¦çŠ¶æ€
const updateBookingStatus = (id, status) => {
  const target = state.bookings.find((item) => item.id === id)
  if (target) target.status = status
}
```

**çŠ¶æ€æµè½¬ï¼š**
```
å¾…ç¡®è®¤ â†’ å·²ç¡®è®¤ â†’ å·²å®Œæˆ
  â†“
å·²å–æ¶ˆ
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
1. é¢„çº¦åˆ›å»º
2. çŠ¶æ€æ›´æ–°
3. é¢„çº¦å–æ¶ˆ
4. é¢„çº¦åˆ é™¤
5. è”ç³»äººä¿¡æ¯ç®¡ç†

---

### 6. æ‹¼ç§Ÿä¿¡æ¯

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/views/MyShareView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// æ‹¼ç§Ÿæ•°æ®æ¨¡å‹
const shareData = ref([
  {
    id: 'share-1',
    roomType: 'ä¸»å§',
    rent: 1800,
    requirements: ['é™å¥³ç”Ÿ', 'ä¸å…»å® ç‰©'],
    houseInfo: {
      title: 'æˆ¿æºæ ‡é¢˜',
      address: 'è¯¦ç»†åœ°å€',
      facilities: ['WiFi', 'ç©ºè°ƒ', 'æ´—è¡£æœº']
    },
    status: 'æ‹›ç§Ÿä¸­',
    publishTime: '2024-11-01'
  }
])
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- æ‹¼ç§Ÿä¿¡æ¯å±•ç¤º
- çŠ¶æ€ç®¡ç†ï¼ˆæ‹›ç§Ÿä¸­/å·²æ»¡å‘˜/å·²ä¸‹æ¶ï¼‰
- ä¿¡æ¯ç¼–è¾‘
- åˆ é™¤åŠŸèƒ½

---

### 7. è®¢å•ç®¡ç†ç³»ç»Ÿ

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/stores/orderStore.js`
- `src/views/MyOrderView.vue`
- `src/views/ServiceDetailView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// orderStore.js æ ¸å¿ƒé€»è¾‘

// è®¢å•çŠ¶æ€å®šä¹‰
const statusTextMap = {
  pending: 'å¾…ç¡®è®¤',
  confirmed: 'å·²ç¡®è®¤',
  processing: 'æœåŠ¡ä¸­',
  completed: 'å·²å®Œæˆ',
  cancelled: 'å·²å–æ¶ˆ'
}

// ç”Ÿæˆå”¯ä¸€è®¢å•å·
const generateOrderNo = () => {
  const timestamp = Date.now()
  const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0')
  return `ORD${timestamp}${random}`
}

// åˆ›å»ºè®¢å•
const createOrder = (orderData, userPhone) => {
  if (!userPhone) {
    return { success: false, message: 'è¯·å…ˆç™»å½•' }
  }

  const order = {
    id: `order-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
    orderNo: generateOrderNo(),
    userPhone: userPhone,
    serviceTitle: orderData.serviceTitle,
    packageName: orderData.packageName,
    packagePrice: orderData.packagePrice,
    date: orderData.date,
    time: orderData.time,
    address: orderData.address,
    contact: orderData.contact,
    phone: orderData.phone,
    status: 'pending',
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString()
  }

  state.orders.unshift(order)
  persist()

  return { success: true, order }
}

// æ›´æ–°è®¢å•çŠ¶æ€
const updateOrderStatus = (orderId, status) => {
  const order = state.orders.find(order => order.id === orderId)
  if (!order) {
    return { success: false, message: 'è®¢å•ä¸å­˜åœ¨' }
  }

  order.status = status
  order.updatedAt = new Date().toISOString()
  persist()

  return { success: true, order }
}

// åˆ é™¤è®¢å•ï¼ˆä»…é™å·²å–æ¶ˆï¼‰
const deleteOrder = (orderId) => {
  const orderIndex = state.orders.findIndex(order => order.id === orderId)
  if (orderIndex === -1) {
    return { success: false, message: 'è®¢å•ä¸å­˜åœ¨' }
  }

  const order = state.orders[orderIndex]
  
  // åªå…è®¸åˆ é™¤å·²å–æ¶ˆçš„è®¢å•
  if (order.status !== 'cancelled') {
    return { success: false, message: 'åªèƒ½åˆ é™¤å·²å–æ¶ˆçš„è®¢å•' }
  }

  state.orders.splice(orderIndex, 1)
  persist()

  return { success: true, message: 'è®¢å•å·²åˆ é™¤' }
}
```

**è®¢å•åˆ›å»ºæµç¨‹ï¼š**

```javascript
// ServiceDetailView.vue ä¸­çš„å®ç°
const handleSubmit = async () => {
  // 1. æ£€æŸ¥ç™»å½•çŠ¶æ€
  if (!authStore.isAuthenticated.value) {
    ElMessageBox.confirm('è¯·å…ˆç™»å½•åå†æäº¤é¢„çº¦', 'æç¤º', {
      confirmButtonText: 'å»ç™»å½•',
      cancelButtonText: 'å–æ¶ˆ',
      type: 'warning'
    }).then(() => {
      router.push('/login')
    })
    return
  }

  // 2. è¡¨å•éªŒè¯
  const valid = await bookingFormRef.value?.validate().catch(() => false)
  if (!valid) return

  // 3. åˆ›å»ºè®¢å•æ•°æ®
  const orderData = {
    serviceTitle: detail.title,
    serviceCover: detail.cover,
    packageName: selectedPkg.name,
    packagePrice: selectedPkg.price,
    date: bookingForm.date,
    time: bookingForm.time,
    address: bookingForm.address,
    contact: bookingForm.contact,
    phone: bookingForm.phone,
    remark: bookingForm.remark
  }

  // 4. æäº¤è®¢å•
  const result = orderStore.createOrder(orderData, authStore.state.currentPhone)
  
  if (result.success) {
    ElMessageBox.confirm(
      `é¢„çº¦æäº¤æˆåŠŸï¼è®¢å•å·ï¼š${result.order.orderNo}`,
      'é¢„çº¦æˆåŠŸ',
      {
        confirmButtonText: 'æŸ¥çœ‹è®¢å•',
        cancelButtonText: 'ç»§ç»­æµè§ˆ',
        type: 'success'
      }
    ).then(() => {
      router.push('/my/orders')
    })
  }
}
```

**è®¢å•çŠ¶æ€ç®¡ç†ï¼š**

```javascript
// MyOrderView.vue ä¸­çš„å®ç°

// é€šç”¨çŠ¶æ€ä¿®æ”¹å™¨
const handleChangeStatus = (order) => {
  const statusOptions = [
    { value: 'pending', label: 'å¾…ç¡®è®¤' },
    { value: 'confirmed', label: 'å·²ç¡®è®¤' },
    { value: 'processing', label: 'æœåŠ¡ä¸­' },
    { value: 'completed', label: 'å·²å®Œæˆ' },
    { value: 'cancelled', label: 'å·²å–æ¶ˆ' }
  ]

  // ä½¿ç”¨HTMLè¡¨å•é€‰æ‹©æ–°çŠ¶æ€
  ElMessageBox.confirm(html, `ä¿®æ”¹è®¢å•çŠ¶æ€`, {
    dangerouslyUseHTMLString: true,
    beforeClose: (action, instance, done) => {
      if (action === 'confirm') {
        const selected = document.querySelector('input[name="newStatus"]:checked')
        if (selected && selected.value !== order.status) {
          const newStatus = selected.value
          const result = orderStore.updateOrderStatus(order.id, newStatus)
          if (result.success) {
            ElMessage.success(`è®¢å•çŠ¶æ€å·²æ›´æ–°`)
            done()
          }
        }
      } else {
        done()
      }
    }
  })
}

// å¿«æ·çŠ¶æ€æ“ä½œ
const handleQuickStatus = (order, newStatus, actionText) => {
  ElMessageBox.confirm(
    `ç¡®è®¤å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸º"${newStatus}"å—ï¼Ÿ`,
    actionText,
    { type: 'warning' }
  ).then(() => {
    const result = orderStore.updateOrderStatus(order.id, newStatus)
    if (result.success) {
      ElMessage.success(`è®¢å•å·²${actionText}`)
    }
  })
}
```

**æ‰¹é‡åˆ é™¤å®ç°ï¼š**

```javascript
const handleDeleteAllCancelled = () => {
  const cancelledOrders = userOrders.value.filter(o => o.status === 'cancelled')
  
  if (cancelledOrders.length === 0) {
    ElMessage.warning('æ²¡æœ‰å·²å–æ¶ˆçš„è®¢å•')
    return
  }

  ElMessageBox.confirm(
    `ç¡®è®¤åˆ é™¤å…¨éƒ¨ ${cancelledOrders.length} ä¸ªå·²å–æ¶ˆçš„è®¢å•å—ï¼Ÿ`,
    'æ‰¹é‡åˆ é™¤',
    { type: 'error' }
  ).then(() => {
    const result = orderStore.deleteCancelledOrders(authStore.state.currentPhone)
    if (result.success) {
      ElMessage.success(result.message)
    }
  })
}
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
1. âœ… è®¢å•åˆ›å»ºï¼ˆä»æœåŠ¡è¯¦æƒ…é¡µï¼‰
2. âœ… çŠ¶æ€æµè½¬ç®¡ç†
3. âœ… é€šç”¨çŠ¶æ€ä¿®æ”¹å™¨
4. âœ… å¿«æ·çŠ¶æ€æŒ‰é’®
5. âœ… åˆ é™¤å·²å–æ¶ˆè®¢å•
6. âœ… æ‰¹é‡åˆ é™¤åŠŸèƒ½
7. âœ… è®¢å•ç­›é€‰ï¼ˆæŒ‰çŠ¶æ€ï¼‰
8. âœ… è®¢å•ç»Ÿè®¡

---

### 8. é’±åŒ…ç³»ç»Ÿ

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/stores/walletStore.js`
- `src/views/MyWalletView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// walletStore.js æ ¸å¿ƒé€»è¾‘

// æ•°æ®ç»“æ„
const state = reactive({
  wallets: {} // { userPhone: { balance, points, transactions } }
})

// è·å–æˆ–åˆ›å»ºç”¨æˆ·é’±åŒ…
const getUserWallet = (userPhone) => {
  if (!userPhone) return null
  
  if (!state.wallets[userPhone]) {
    state.wallets[userPhone] = {
      balance: 0,         // ä½™é¢ï¼ˆå…ƒï¼‰
      points: 15,         // è°·ç²’ç‚¹ï¼ˆåˆå§‹15ç‚¹ï¼‰
      transactions: []    // äº¤æ˜“è®°å½•
    }
    persist()
  }
  
  return state.wallets[userPhone]
}

// å……å€¼é€»è¾‘
const recharge = (userPhone, amount) => {
  if (!userPhone || !amount || amount <= 0) {
    return { success: false, message: 'å……å€¼é‡‘é¢å¿…é¡»å¤§äº0' }
  }
  
  const wallet = getUserWallet(userPhone)
  wallet.balance += Number(amount)
  
  // å……å€¼èµ é€ç§¯åˆ†ï¼ˆå……å€¼100å…ƒé€10ç§¯åˆ†ï¼‰
  const bonusPoints = Math.floor(amount / 10)
  if (bonusPoints > 0) {
    wallet.points += bonusPoints
  }
  
  // æ·»åŠ äº¤æ˜“è®°å½•
  addTransaction(userPhone, {
    type: 'recharge',
    amount: Number(amount),
    points: bonusPoints,
    description: `å……å€¼ Â¥${amount}${bonusPoints > 0 ? `ï¼Œèµ é€${bonusPoints}è°·ç²’ç‚¹` : ''}`,
    status: 'completed'
  })
  
  persist()
  
  return { success: true, message: `å……å€¼æˆåŠŸ`, balance: wallet.balance }
}

// æç°é€»è¾‘
const withdraw = (userPhone, amount) => {
  const wallet = getUserWallet(userPhone)
  
  if (wallet.balance < amount) {
    return { success: false, message: 'ä½™é¢ä¸è¶³' }
  }
  
  wallet.balance -= Number(amount)
  
  addTransaction(userPhone, {
    type: 'withdraw',
    amount: Number(amount),
    description: `æç° Â¥${amount}`,
    status: 'pending'  // æç°çŠ¶æ€ä¸ºå¤„ç†ä¸­
  })
  
  persist()
  
  return { 
    success: true, 
    message: 'æç°ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡1-3ä¸ªå·¥ä½œæ—¥åˆ°è´¦',
    balance: wallet.balance
  }
}

// èµšå–ç§¯åˆ†
const earnPoints = (userPhone, points, description) => {
  const wallet = getUserWallet(userPhone)
  wallet.points += Number(points)
  
  addTransaction(userPhone, {
    type: 'points_earn',
    amount: 0,
    points: Number(points),
    description: description || `è·å¾—${points}è°·ç²’ç‚¹`,
    status: 'completed'
  })
  
  persist()
  
  return { success: true, message: `è·å¾—${points}è°·ç²’ç‚¹`, points: wallet.points }
}

// ä½¿ç”¨ç§¯åˆ†
const usePoints = (userPhone, points, description) => {
  const wallet = getUserWallet(userPhone)
  
  if (wallet.points < points) {
    return { success: false, message: 'ç§¯åˆ†ä¸è¶³' }
  }
  
  wallet.points -= Number(points)
  
  addTransaction(userPhone, {
    type: 'points_use',
    amount: 0,
    points: -Number(points),
    description: description || `ä½¿ç”¨${points}è°·ç²’ç‚¹`,
    status: 'completed'
  })
  
  persist()
  
  return { success: true, message: `ä½¿ç”¨${points}è°·ç²’ç‚¹æˆåŠŸ` }
}

// äº¤æ˜“è®°å½•ç”Ÿæˆ
const addTransaction = (userPhone, transaction) => {
  const wallet = getUserWallet(userPhone)
  if (!wallet) return
  
  const newTransaction = {
    id: generateTransactionId(),
    type: transaction.type,
    amount: transaction.amount,
    points: transaction.points || 0,
    description: transaction.description,
    status: transaction.status || 'completed',
    createdAt: new Date().toISOString()
  }
  
  wallet.transactions.unshift(newTransaction)
  persist()
  
  return newTransaction
}
```

**äº¤æ˜“ç±»å‹å®šä¹‰ï¼š**

```javascript
const transactionTypeMap = {
  recharge: 'å……å€¼',
  withdraw: 'æç°',
  payment: 'æ”¯ä»˜',
  refund: 'é€€æ¬¾',
  points_earn: 'ç§¯åˆ†è·å¾—',
  points_use: 'ç§¯åˆ†ä½¿ç”¨'
}

const statusTextMap = {
  pending: 'å¤„ç†ä¸­',
  completed: 'å·²å®Œæˆ',
  failed: 'å¤±è´¥'
}
```

**UIäº¤äº’å®ç°ï¼š**

```javascript
// MyWalletView.vue

// å……å€¼å¯¹è¯æ¡†
const handleRecharge = () => {
  const amount = Number(rechargeAmount.value)
  
  ElMessageBox.confirm(
    `ç¡®è®¤å……å€¼ Â¥${amount} åˆ°è´¦æˆ·å—ï¼Ÿå……å€¼100å…ƒå¯è·èµ 10è°·ç²’ç‚¹ã€‚`,
    'ç¡®è®¤å……å€¼',
    { type: 'success' }
  ).then(() => {
    const result = walletStore.recharge(authStore.state.currentPhone, amount)
    if (result.success) {
      ElMessage.success(result.message)
      rechargeDialogVisible.value = false
      rechargeAmount.value = ''
    }
  })
}

// æ¯æ—¥ç­¾åˆ°
const handleSignIn = () => {
  const randomPoints = Math.floor(Math.random() * 5) + 5 // 5-10ç§¯åˆ†
  const result = walletStore.earnPoints(
    authStore.state.currentPhone,
    randomPoints,
    `æ¯æ—¥ç­¾åˆ°å¥–åŠ±`
  )
  if (result.success) {
    ElMessage.success(result.message)
  }
}

// ç§¯åˆ†å…‘æ¢ä½™é¢
const handleExchangePoints = () => {
  const points = 100  // 100ç§¯åˆ†
  const amount = 10   // å…‘æ¢10å…ƒ
  
  if (userWallet.value.points < points) {
    ElMessage.error('ç§¯åˆ†ä¸è¶³')
    return
  }
  
  ElMessageBox.confirm(
    `ç¡®è®¤ä½¿ç”¨ ${points} è°·ç²’ç‚¹å…‘æ¢ Â¥${amount} å—ï¼Ÿ`,
    'ç§¯åˆ†å…‘æ¢',
    { type: 'success' }
  ).then(() => {
    // æ‰£é™¤ç§¯åˆ†
    const useResult = walletStore.usePoints(
      authStore.state.currentPhone,
      points,
      `å…‘æ¢ä½™é¢ Â¥${amount}`
    )
    
    if (useResult.success) {
      // å¢åŠ ä½™é¢
      walletStore.recharge(authStore.state.currentPhone, amount)
      ElMessage.success('å…‘æ¢æˆåŠŸ')
    }
  })
}
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
1. âœ… ä½™é¢ç®¡ç†ï¼ˆå……å€¼/æç°ï¼‰
2. âœ… è°·ç²’ç‚¹ç³»ç»Ÿï¼ˆç­¾åˆ°/å…‘æ¢ï¼‰
3. âœ… å……å€¼å¥–åŠ±æœºåˆ¶
4. âœ… äº¤æ˜“è®°å½•æŸ¥è¯¢
5. âœ… åˆ†ç±»ç­›é€‰
6. âœ… çŠ¶æ€è¿½è¸ª

---

### 9. ä¸ªäººèµ„æ–™ç®¡ç†

#### æŠ€æœ¯å®ç°

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `src/views/UserProfileView.vue`

**å®ç°åŸç†ï¼š**

```javascript
// èµ„æ–™è¡¨å•
const profileForm = reactive({
  avatar: '',
  name: '',
  nickname: '',
  gender: '',
  birthday: '',
  phone: '',
  email: '',
  signature: '',
  password: ''
})

// åŠ è½½ç”¨æˆ·æ•°æ®
const loadUserData = () => {
  const user = authStore.currentUser.value
  if (!user) {
    ElMessage.warning('è¯·å…ˆç™»å½•')
    router.push('/login')
    return
  }
  
  profileForm.avatar = user.avatar || assetUrl('avatars/avatar-default.svg')
  profileForm.name = user.name || ''
  profileForm.nickname = user.nickname || ''
  profileForm.gender = user.gender || ''
  profileForm.birthday = user.birthday || ''
  profileForm.phone = user.phone || ''
  profileForm.email = user.email || ''
  profileForm.signature = user.signature || ''
  profileForm.password = ''
}

// å¤´åƒä¸Šä¼ 
const handleAvatarChange = (uploadFile) => {
  const reader = new FileReader()
  reader.onload = () => {
    profileForm.avatar = reader.result  // Base64æ ¼å¼
  }
  reader.readAsDataURL(uploadFile.raw)
}

// æäº¤æ›´æ–°
const handleSubmit = async () => {
  const valid = await profileFormRef.value?.validate().catch(() => false)
  if (!valid) {
    ElMessage.warning('è¯·å¡«å†™æ­£ç¡®çš„ä¿¡æ¯')
    return
  }
  
  const updates = {
    name: profileForm.name,
    nickname: profileForm.nickname,
    avatar: profileForm.avatar,
    gender: profileForm.gender,
    birthday: profileForm.birthday,
    email: profileForm.email,
    signature: profileForm.signature
  }
  
  // å¦‚æœå¡«å†™äº†å¯†ç ï¼Œåˆ™æ›´æ–°å¯†ç 
  if (profileForm.password && profileForm.password.length >= 6) {
    updates.password = profileForm.password
  }
  
  const result = authStore.updateUserProfile(updates)
  
  if (result.success) {
    ElMessage.success('èµ„æ–™æ›´æ–°æˆåŠŸ')
    profileForm.password = ''
    setTimeout(() => {
      router.push('/my')
    }, 1500)
  }
}
```

**è¡¨å•éªŒè¯è§„åˆ™ï¼š**

```javascript
const rules = {
  name: [{ required: true, message: 'è¯·è¾“å…¥å§“å', trigger: 'blur' }],
  phone: [
    { required: true, message: 'è¯·è¾“å…¥æ‰‹æœºå·', trigger: 'blur' },
    { pattern: /^1\d{10}$/, message: 'æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®', trigger: ['blur', 'change'] }
  ],
  email: [
    { type: 'email', message: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®', trigger: ['blur', 'change'] }
  ],
  password: [
    { min: 6, message: 'å¯†ç è‡³å°‘ 6 ä½', trigger: 'blur' }
  ]
}
```

---

## çŠ¶æ€ç®¡ç†è®¾è®¡

### ReactiveçŠ¶æ€ç®¡ç†æ¨¡å¼

**è®¾è®¡ç†å¿µï¼š**
- ä½¿ç”¨Vue 3çš„`reactive`å’Œ`computed`è¿›è¡ŒçŠ¶æ€ç®¡ç†
- è½»é‡çº§ï¼Œæ— éœ€é¢å¤–ä¾èµ–
- å®Œç¾é€‚é…ç»„åˆå¼API

**Storeè®¾è®¡æ¨¡å¼ï¼š**

```javascript
// é€šç”¨Storeæ¨¡å¼
import { computed, reactive } from 'vue'

// 1. å®šä¹‰çŠ¶æ€
const state = reactive({
  data: [],
  loading: false,
  error: null
})

// 2. å®šä¹‰è®¡ç®—å±æ€§
const computedValue = computed(() => {
  return state.data.filter(item => item.active)
})

// 3. å®šä¹‰æ–¹æ³•
const addItem = (item) => {
  state.data.push(item)
}

const updateItem = (id, updates) => {
  const item = state.data.find(i => i.id === id)
  if (item) {
    Object.assign(item, updates)
  }
}

// 4. å¯¼å‡º
export const useStore = () => ({
  state,
  computedValue,
  addItem,
  updateItem
})
```

### è·¨Storeé€šä¿¡

**ç¤ºä¾‹ï¼šauthStoreä¸walletStoreçš„åŒæ­¥**

```javascript
// authStore.js
const currentUser = computed(() => {
  if (!state.currentPhone) return null
  const user = findUser(state.currentPhone)
  if (!user) return null
  
  // åŒæ­¥é’±åŒ…ç§¯åˆ†åˆ°ç”¨æˆ·æ•°æ®
  try {
    const walletStore = useWalletStore()
    const wallet = walletStore.getUserWallet(state.currentPhone)
    if (wallet) {
      user.points = wallet.points  // å®æ—¶åŒæ­¥
    }
  } catch (error) {
    // å¿½ç•¥é”™è¯¯ï¼ˆé’±åŒ…å¯èƒ½æœªåˆå§‹åŒ–ï¼‰
  }
  
  return user
})
```

---

## æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ

### localStorageå­˜å‚¨ç­–ç•¥

**å­˜å‚¨é”®è®¾è®¡ï¼š**
```javascript
const STORAGE_KEYS = {
  AUTH: 'link-house-auth',      // ç”¨æˆ·è®¤è¯æ•°æ®
  ORDERS: 'link-house-orders',  // è®¢å•æ•°æ®
  WALLET: 'link-house-wallet'   // é’±åŒ…æ•°æ®
}
```

**æŒä¹…åŒ–å®ç°ï¼š**

```javascript
// ç»Ÿä¸€æŒä¹…åŒ–å‡½æ•°
const persist = (key, data) => {
  if (typeof window === 'undefined') return
  try {
    window.localStorage.setItem(key, JSON.stringify(data))
  } catch (error) {
    console.error('æ•°æ®æŒä¹…åŒ–å¤±è´¥:', error)
  }
}

// ç»Ÿä¸€åŠ è½½å‡½æ•°
const loadFromStorage = (key, defaultValue = null) => {
  if (typeof window === 'undefined') return defaultValue
  try {
    const raw = window.localStorage.getItem(key)
    if (!raw) return defaultValue
    return JSON.parse(raw)
  } catch (error) {
    console.warn('æ•°æ®åŠ è½½å¤±è´¥:', error)
    return defaultValue
  }
}
```

**æ•°æ®ç»“æ„ç¤ºä¾‹ï¼š**

```javascript
// link-house-auth
{
  users: [
    {
      id: 'user-123',
      phone: '18512345678',
      name: 'å°è°·ç²’',
      avatar: 'base64...',
      points: 156
    }
  ],
  currentPhone: '18512345678'
}

// link-house-orders
[
  {
    id: 'order-123',
    orderNo: 'ORD1730000001234',
    userPhone: '18512345678',
    status: 'pending',
    // ...å…¶ä»–å­—æ®µ
  }
]

// link-house-wallet
{
  '18512345678': {
    balance: 2580.00,
    points: 156,
    transactions: [...]
  }
}
```

---

## è·¯ç”±è®¾è®¡

### è·¯ç”±é…ç½®

```javascript
// router/index.js
const routes = [
  {
    path: '/my',
    name: 'my',
    component: () => import('../views/MyView.vue'),
    meta: {
      title: 'æˆ‘çš„',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/want',
    name: 'my-want',
    component: () => import('../views/MyWantView.vue'),
    meta: {
      title: 'æˆ‘çš„æƒ³çœ‹',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/footprint',
    name: 'my-footprint',
    component: () => import('../views/MyFootprintView.vue'),
    meta: {
      title: 'æˆ‘çš„è¶³è¿¹',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/appointment',
    name: 'my-appointment',
    component: () => import('../views/MyAppointmentView.vue'),
    meta: {
      title: 'æˆ‘çš„çº¦çœ‹',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/share',
    name: 'my-share',
    component: () => import('../views/MyShareView.vue'),
    meta: {
      title: 'æˆ‘çš„æ‹¼ç§Ÿ',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/orders',
    name: 'my-orders',
    component: () => import('../views/MyOrderView.vue'),
    meta: {
      title: 'æˆ‘çš„è®¢å•',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/wallet',
    name: 'my-wallet',
    component: () => import('../views/MyWalletView.vue'),
    meta: {
      title: 'æˆ‘çš„é’±åŒ…',
      activeMenu: '/my'
    }
  },
  {
    path: '/my/profile',
    name: 'user-profile',
    component: () => import('../views/UserProfileView.vue'),
    meta: {
      title: 'ä¸ªäººèµ„æ–™',
      activeMenu: '/my'
    }
  },
  {
    path: '/login',
    name: 'login',
    component: () => import('../views/LoginView.vue'),
    meta: {
      title: 'ç™»å½•',
      layout: 'blank'
    }
  }
]
```

### è·¯ç”±å®ˆå«

```javascript
// å…¨å±€åç½®é’©å­ - æ›´æ–°é¡µé¢æ ‡é¢˜
router.afterEach((to) => {
  if (to.meta?.title) {
    document.title = `${to.meta.title} - Link House`
  } else {
    document.title = 'Link House'
  }
})

// å¯ä»¥æ·»åŠ çš„è·¯ç”±å®ˆå«ç¤ºä¾‹
router.beforeEach((to, from, next) => {
  // æ£€æŸ¥ç™»å½•çŠ¶æ€
  const authStore = useAuthStore()
  const requiresAuth = to.meta.requiresAuth
  
  if (requiresAuth && !authStore.isAuthenticated.value) {
    next('/login')
  } else {
    next()
  }
})
```

---

## ç»„ä»¶é€šä¿¡æœºåˆ¶

### 1. Props/Emitsï¼ˆçˆ¶å­ç»„ä»¶ï¼‰

```javascript
// çˆ¶ç»„ä»¶
<BookingDialog 
  :visible="state.dialogVisible"
  :preset="state.preset"
  @close="closeBookingDialog"
  @submit="addBooking"
/>

// å­ç»„ä»¶
const props = defineProps({
  visible: Boolean,
  preset: Object
})

const emit = defineEmits(['close', 'submit'])

const handleSubmit = () => {
  emit('submit', formData)
}
```

### 2. Provide/Injectï¼ˆè·¨å±‚çº§ï¼‰

```javascript
// ç¥–å…ˆç»„ä»¶
provide('theme', {
  primaryColor: '#0c9f71',
  fontSize: 14
})

// åä»£ç»„ä»¶
const theme = inject('theme')
```

### 3. Storeï¼ˆå…¨å±€çŠ¶æ€ï¼‰

```javascript
// ç»„ä»¶A
const authStore = useAuthStore()
authStore.login(credentials)

// ç»„ä»¶B
const authStore = useAuthStore()
const user = authStore.currentUser.value
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. è®¡ç®—å±æ€§ç¼“å­˜

```javascript
// ä½¿ç”¨computedç¼“å­˜å¤æ‚è®¡ç®—
const filteredData = computed(() => {
  // åªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—
  return data.value.filter(item => item.active)
})
```

### 2. è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§åˆ—è¡¨ï¼‰

```javascript
// åˆ†é¡µå®ç°
const paginatedData = computed(() => {
  const start = (currentPage.value - 1) * pageSize.value
  return allData.value.slice(start, start + pageSize.value)
})
```

### 3. æ‡’åŠ è½½

```javascript
// è·¯ç”±æ‡’åŠ è½½
component: () => import('../views/MyOrderView.vue')

// å›¾ç‰‡æ‡’åŠ è½½
<el-image lazy :src="imageUrl" />
```

### 4. é˜²æŠ–èŠ‚æµ

```javascript
import { debounce } from 'lodash-es'

const handleSearch = debounce((keyword) => {
  // æœç´¢é€»è¾‘
}, 300)
```

### 5. ç»„ä»¶æŒ‰éœ€åŠ è½½

```javascript
// Element PlusæŒ‰éœ€å¼•å…¥
import { ElButton, ElMessage } from 'element-plus'
```

---

## å®‰å…¨æ€§è€ƒè™‘

### 1. XSSé˜²æŠ¤

```javascript
// ä½¿ç”¨æ¡†æ¶æä¾›çš„å®‰å…¨æœºåˆ¶
<div>{{ userInput }}</div>  // Vueè‡ªåŠ¨è½¬ä¹‰

// å±é™©æ“ä½œéœ€è¦æ˜ç¡®æ ‡è®°
<div v-html="trustedHtml"></div>  // ä»…ç”¨äºå¯ä¿¡å†…å®¹
```

### 2. æ•°æ®éªŒè¯

```javascript
// å‰ç«¯éªŒè¯
const validatePhone = (phone) => {
  return /^1\d{10}$/.test(phone)
}

// åç«¯éªŒè¯ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…éœ€ï¼‰
// APIå±‚è¿›è¡ŒäºŒæ¬¡éªŒè¯
```

### 3. æ•æ„Ÿä¿¡æ¯å¤„ç†

```javascript
// ä¸å­˜å‚¨æ˜æ–‡å¯†ç 
const hashPassword = (password) => {
  // å®é™…åº”ç”¨ä¸­ä½¿ç”¨åŠ å¯†ç®—æ³•
  return btoa(password)  // ç¤ºä¾‹ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨bcryptç­‰
}

// localStorageä¸­ä¸å­˜å‚¨æ•æ„Ÿä¿¡æ¯
// ç”Ÿäº§ç¯å¢ƒä½¿ç”¨httpOnly cookie + JWT
```

### 4. CSRFé˜²æŠ¤

```javascript
// æ·»åŠ CSRF tokenï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
axios.defaults.headers.common['X-CSRF-Token'] = getCsrfToken()
```

---

## æœªæ¥ä¼˜åŒ–æ–¹å‘

### 1. åç«¯é›†æˆ

**å½“å‰çŠ¶æ€ï¼š** ä½¿ç”¨localStorageæ¨¡æ‹Ÿæ•°æ®å­˜å‚¨

**ä¼˜åŒ–æ–¹å‘ï¼š**
- é›†æˆRESTful API
- ä½¿ç”¨JWTè¿›è¡Œèº«ä»½è®¤è¯
- å®ç°çœŸå®çš„æ”¯ä»˜æ¥å£
- WebSocketå®æ—¶é€šçŸ¥

```javascript
// APIå°è£…ç¤ºä¾‹
import axios from 'axios'

const api = axios.create({
  baseURL: process.env.VUE_APP_API_URL,
  timeout: 10000
})

// è¯·æ±‚æ‹¦æˆªå™¨
api.interceptors.request.use(config => {
  const token = getToken()
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// å“åº”æ‹¦æˆªå™¨
api.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      // è·³è½¬ç™»å½•
      router.push('/login')
    }
    return Promise.reject(error)
  }
)
```

### 2. çŠ¶æ€ç®¡ç†å‡çº§

**å½“å‰çŠ¶æ€ï¼š** Reactive API

**ä¼˜åŒ–æ–¹å‘ï¼š**
- ä½¿ç”¨Piniaè¿›è¡Œæ›´ç»“æ„åŒ–çš„çŠ¶æ€ç®¡ç†
- æ·»åŠ çŠ¶æ€æŒä¹…åŒ–æ’ä»¶
- å®ç°çŠ¶æ€å¿«ç…§å’Œæ—¶é—´æ—…è¡Œ

```javascript
// Piniaç¤ºä¾‹
import { defineStore } from 'pinia'

export const useAuthStore = defineStore('auth', {
  state: () => ({
    user: null,
    token: null
  }),
  
  getters: {
    isAuthenticated: (state) => !!state.token
  },
  
  actions: {
    async login(credentials) {
      const { data } = await api.post('/login', credentials)
      this.user = data.user
      this.token = data.token
    }
  },
  
  // æŒä¹…åŒ–
  persist: {
    enabled: true,
    strategies: [
      {
        key: 'auth',
        storage: localStorage
      }
    ]
  }
})
```

### 3. å®æ—¶åŠŸèƒ½

**ä¼˜åŒ–æ–¹å‘ï¼š**
- WebSocketæ¶ˆæ¯æ¨é€
- è®¢å•çŠ¶æ€å®æ—¶æ›´æ–°
- åœ¨çº¿å®¢æœèŠå¤©

```javascript
// WebSocketå°è£…
class WebSocketClient {
  constructor(url) {
    this.ws = new WebSocket(url)
    this.setupEventHandlers()
  }
  
  setupEventHandlers() {
    this.ws.onopen = () => {
      console.log('WebSocketè¿æ¥æˆåŠŸ')
    }
    
    this.ws.onmessage = (event) => {
      const message = JSON.parse(event.data)
      this.handleMessage(message)
    }
  }
  
  handleMessage(message) {
    switch (message.type) {
      case 'ORDER_UPDATE':
        orderStore.updateOrderStatus(message.orderId, message.status)
        break
      case 'WALLET_CHANGE':
        walletStore.syncBalance(message.balance)
        break
    }
  }
  
  send(data) {
    this.ws.send(JSON.stringify(data))
  }
}
```

### 4. æ€§èƒ½ç›‘æ§

**ä¼˜åŒ–æ–¹å‘ï¼š**
- æ·»åŠ æ€§èƒ½ç›‘æ§
- é”™è¯¯è¿½è¸ª
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

```javascript
// æ€§èƒ½ç›‘æ§ç¤ºä¾‹
import { onMounted } from 'vue'

onMounted(() => {
  // é¡µé¢åŠ è½½æ—¶é—´
  const perfData = performance.getEntriesByType('navigation')[0]
  console.log('é¡µé¢åŠ è½½æ—¶é—´:', perfData.loadEventEnd - perfData.fetchStart)
  
  // é¦–å±æ¸²æŸ“æ—¶é—´
  const paint = performance.getEntriesByType('paint')
  console.log('é¦–å±æ¸²æŸ“:', paint)
})

// é”™è¯¯è¿½è¸ª
window.addEventListener('error', (event) => {
  // å‘é€åˆ°ç›‘æ§å¹³å°
  sendToMonitoring({
    type: 'error',
    message: event.message,
    stack: event.error?.stack
  })
})
```

### 5. ç§»åŠ¨ç«¯ä¼˜åŒ–

**ä¼˜åŒ–æ–¹å‘ï¼š**
- PWAæ”¯æŒ
- ç¦»çº¿ç¼“å­˜
- ç§»åŠ¨ç«¯æ‰‹åŠ¿æ“ä½œ
- åŸç”Ÿèƒ½åŠ›è°ƒç”¨

```javascript
// Service Workeræ³¨å†Œ
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js')
    .then(reg => console.log('SW registered', reg))
    .catch(err => console.log('SW registration failed', err))
}

// æ·»åŠ åˆ°ä¸»å±å¹•
let deferredPrompt
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault()
  deferredPrompt = e
  showInstallButton()
})
```

### 6. æµ‹è¯•è¦†ç›–

**ä¼˜åŒ–æ–¹å‘ï¼š**
- å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰
- ç»„ä»¶æµ‹è¯•ï¼ˆVue Test Utilsï¼‰
- E2Eæµ‹è¯•ï¼ˆPlaywrightï¼‰

```javascript
// å•å…ƒæµ‹è¯•ç¤ºä¾‹
import { describe, it, expect } from 'vitest'
import { useAuthStore } from '@/stores/authStore'

describe('AuthStore', () => {
  it('should register new user', () => {
    const authStore = useAuthStore()
    const result = authStore.registerUser({
      phone: '13800138000',
      name: 'æµ‹è¯•ç”¨æˆ·'
    })
    
    expect(result.success).toBe(true)
    expect(result.user.phone).toBe('13800138000')
  })
  
  it('should validate phone format', () => {
    const authStore = useAuthStore()
    const result = authStore.registerUser({
      phone: '123',
      name: 'æµ‹è¯•ç”¨æˆ·'
    })
    
    expect(result.success).toBe(false)
    expect(result.message).toContain('æ‰‹æœºå·')
  })
})
```

---

## æ€»ç»“

### æŠ€æœ¯äº®ç‚¹

1. **ç»„åˆå¼API**ï¼šå……åˆ†åˆ©ç”¨Vue 3çš„ç»„åˆå¼APIï¼Œä»£ç ç»„ç»‡æ›´æ¸…æ™°
2. **å“åº”å¼çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨Reactiveå®ç°è½»é‡çº§çŠ¶æ€ç®¡ç†
3. **æ•°æ®æŒä¹…åŒ–**ï¼šlocalStorageå®ç°æœ¬åœ°æ•°æ®å­˜å‚¨
4. **ç»„ä»¶åŒ–è®¾è®¡**ï¼šé«˜å†…èšä½è€¦åˆçš„ç»„ä»¶æ¶æ„
5. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨computedå’Œreactiveä¿è¯ç±»å‹å®‰å…¨
6. **ç”¨æˆ·ä½“éªŒ**ï¼šå®Œå–„çš„äº¤äº’åé¦ˆå’Œé”™è¯¯å¤„ç†

### æ ¸å¿ƒä¼˜åŠ¿

- âœ… **è½»é‡çº§**ï¼šæ— é‡åº¦ä¾èµ–ï¼Œæ‰“åŒ…ä½“ç§¯å°
- âœ… **é«˜æ€§èƒ½**ï¼šè®¡ç®—å±æ€§ç¼“å­˜ï¼Œè™šæ‹Ÿæ»šåŠ¨
- âœ… **æ˜“ç»´æŠ¤**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œä»£ç æ¸…æ™°
- âœ… **å¯æ‰©å±•**ï¼šé¢„ç•™æ¥å£ï¼Œä¾¿äºåç«¯é›†æˆ
- âœ… **å“åº”å¼**ï¼šç§»åŠ¨ç«¯é€‚é…å®Œå–„

### é€‚ç”¨åœºæ™¯

- ğŸ¯ ä¸­å°å‹ç§Ÿæˆ¿å¹³å°
- ğŸ¯ ä¸ªäººä¸­å¿ƒç³»ç»Ÿ
- ğŸ¯ è®¢å•ç®¡ç†ç³»ç»Ÿ
- ğŸ¯ é’±åŒ…ç§¯åˆ†ç³»ç»Ÿ
- ğŸ¯ Vue 3å­¦ä¹ é¡¹ç›®

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2024-11-06  
**ä½œè€…ï¼š** Claude AI Assistant  
**é¡¹ç›®ï¼š** Link House ç§Ÿæˆ¿APP

